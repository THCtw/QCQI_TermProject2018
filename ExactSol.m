% Input number N
N = input('Number N: ');
    
% Creating operators
I = [1, 0; 0, 1];
Sz = [1, 0; 0, -1];
Sx = [0, 1; 1, 0];

% Getting Hamiltonian 
H1 = zeros(2^N);
H2 = zeros(2^N);
%H1
for i = 1:N
    if i == 1 || i == N
        temp = Sz;
    else
        temp = I;
    end
    for j = 2:N
        if j == i || j == i+1
            temp = kron(temp, Sz);
        else
            temp = kron(temp, I);
        end
    end
    H1 = H1 + temp;
end
%H2
for i = 1:N
    if i == 1
        temp = Sx;
    else
        temp = I;
    end
    for j = 2:N
        if j == i
            temp = kron(temp, Sx);
        else
            temp = kron(temp, I);
        end
    end
    H2 = H2 + temp;
end

% Diagonalization & Finding ground state
% H = -H1 - h*H2
E = zeros(1, 31);
for i = 1:31
    h = (i-1)/10;
    H = -H1 - h*H2;
    E(i) = min(eig(H))/N;
end

% Eigenvector (Ground state)
h = 3;
[V, D] = eig(H);
V1 = V(:, 1);

E_simu_sec_I_C = [-0.763702392578125, -0.7649673461914063, -0.7757873535156249, -0.82066650390625, -0.7727577209472656, -0.80859375, -0.8104957580566408, -0.8499868392944336, -0.8948425292968749, -0.8921833038330078, -0.9359016418457031, -1.0613395690917968, -1.137931251525879, -1.0572368621826171, -1.2010517120361328, -1.2705802917480469, -1.3761157989501953, -1.4619524002075195, -1.5469919204711915, -1.6495838165283203, -1.6813087463378906, -1.835929870605469, -1.5272294998168945, -1.290570068359375, -1.1045989990234375, -2.111708641052246, -1.786845397949219, -1.5214042663574219, -2.4206371307373047,-2.538253784179688, -1.5617341995239258];
E_simu_sec_I_C_thetafix_0 = [-1.0, -1.0016601562499998, -1.00400390625, -1.0026367187499998, -1.028125, -1.0370292663574219, -1.0475250244140626, -1.1349924087524415, -1.166485595703125, -1.2130962371826173, -1.2296142578125, -1.2993011474609375, -1.3879863739013674, -1.3178932189941406, -1.447471809387207, -1.5612916946411133, -1.6091714859008792, -1.7082550048828125,-1.7879161834716795, -1.206640625, -1.8459224700927734, -1.934233856201172, -2.0687379837036133, -2.276765632629395, -2.400724792480469, -2.50022029876709, -2.3827270507812504, -2.5145542144775392, -2.6114498138427735, -2.7453466415405274, -2.7684459686279297];
E_simu_sec_I_C_thetafix_02 = [-1.0, -1.0005859375, -1.00302734375, -1.0058593750000002, -1.008984375, -1.04949951171875, -1.058554458618164, -1.111250114440918, -1.1674308776855469, -1.1415847778320314, -1.1947212219238281, -1.3139801025390625, -1.379344367980957, -1.4527891159057618, -1.500839996337891, -1.5117607116699219, -1.6076362609863282, -1.7236829757690433, -1.8025135040283202, -1.8355745315551757, -1.9591922760009766, -1.7670494079589845, -2.166059494018555, -2.293766021728516, -2.223362731933594, -2.3543148040771484, -2.501447677612305, -2.664253807067871, -2.703738021850586, -2.8367544174194337, -2.8279571533203125];
E_simu_sec_I_C_thetafix0_phifix0 = [-1.0, -1.0027832031249997, -1.0032226562500002, -1.0014648437499998, -1.014453125, -1.0519704818725586, -1.0735235214233398, -1.0842784881591796, -1.1396820068359377, -1.1594743728637695, -1.221099853515625, -1.2904012680053711, -1.1035156249999998, -1.3859607696533205, -1.4896224975585939, -1.543147087097168, -1.5942871093750002, -1.6971483230590823, -1.8195096969604494, -1.6349063873291017, -1.8577327728271484, -2.008390426635742, -2.163435745239258, -2.2649854660034183, -1.6333110809326175, -2.400360107421875, -2.532398223876953, -2.578763961791992, -2.7783157348632814, -2.660643577575684, -3.0001487731933594];

E_simu_fir_I_C = [-1.0, -1.0003906249999999, -1.0023437499999999, -1.006005859375, -1.0113281250000001, -1.0423402786254883, -1.0933965682983398, -1.103759765625, -1.1364044189453124, -1.2370712280273437, -1.1563749313354492, -1.2894187927246095, -1.3498760223388673, -1.409562873840332, -1.4820428848266602, -1.557509422302246, -1.6508068084716796, -1.6849731445312501, -1.7890750885009767, -1.42921142578125, -1.9462518692016602, -1.7381683349609376, -2.1195911407470702, -2.2821434020996096, -1.9582288742065435, -2.248659133911133, -2.4946771621704102, -2.650674057006836, -2.1948669433593753, -2.8431663513183594, -2.92611026763916];

Erroravgsec = 0.0;
Erroravgfir = 0.0;


for i = 1:31
    Erroravgsec = Erroravgsec + (E_simu_sec_I_C_thetafix_02(i) - E(1, i))/ E(1, i);
    Erroravgfir = Erroravgfir + (E_simu_fir_I_C(i) - E(1, i))/ E(1, i);
end

Erroravgsec = Erroravgsec/31;
Erroravgfir = Erroravgfir/31;

%Plot 
index = 1:31;
figure;
plot ( (index-1)/10, E);
hold on;
plot ( (index-1)/10, E_simu_sec_I_C_thetafix0_phifix0, '*');
hold on;
plot ( (index-1)/10, E_simu_fir_I_C, 'o');
legend( 'exact', 'simu-sec', 'simu-fir');
xlabel('h');
ylabel('E/N');
set(gca,'FontSize', 18, 'FontWeight', 'bold', 'LineWidth', 1.5);



%figure;
%plot(V1);